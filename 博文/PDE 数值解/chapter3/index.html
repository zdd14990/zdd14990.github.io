
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="数学专业大三学生的数字花园，记录分析、代数与应用数学笔记。">
      
      
        <meta name="author" content="zdd">
      
      
        <link rel="canonical" href="https://zdd14990.github.io/%E5%8D%9A%E6%96%87/PDE%20%E6%95%B0%E5%80%BC%E8%A7%A3/chapter3/">
      
      
      
      
        
      
      
      <link rel="icon" href="../../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>第三章：双曲型方程的有限差分法 - zdd14990</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
   <meta name="description" content="数学专业大三学生的数字花园，记录分析、代数与应用数学笔记。">
  <meta name="author" content="zdd">

  <meta property="og:type" content="website">
  <meta property="og:url" content="https://zdd14990.github.io/%E5%8D%9A%E6%96%87/PDE%20%E6%95%B0%E5%80%BC%E8%A7%A3/chapter3/">
  <meta property="og:title" content="第三章：双曲型方程的有限差分法 - zdd14990">
  <meta property="og:description" content="数学专业大三学生的数字花园，记录分析、代数与应用数学笔记。">
  <meta property="og:image" content="https://zdd14990.github.io/assets/cover.jpg">

  <meta name="twitter:card" content="summary_large_image">
  <meta property="twitter:domain" content="zdd14990.github.io">
  <meta property="twitter:url" content="https://zdd14990.github.io/%E5%8D%9A%E6%96%87/PDE%20%E6%95%B0%E5%80%BC%E8%A7%A3/chapter3/">
  <meta name="twitter:title" content="第三章：双曲型方程的有限差分法 - zdd14990">
  <meta name="twitter:description" content="数学专业大三学生的数字花园，记录分析、代数与应用数学笔记。">
  <meta name="twitter:image" content="https://zdd14990.github.io/assets/cover.jpg">

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="zdd14990" class="md-header__button md-logo" aria-label="zdd14990" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 8-1.33.09C9.81 7.07 7.4 4.5 5 4.5c0 0-1.97 2.96-.04 6.91-.55.83-.89 1.26-.96 2.25l-1.93.29.21.98 1.76-.26.14.71-1.57.94.47.89 1.45-.89C5.68 18.76 8.59 20 12 20s6.32-1.24 7.47-3.68l1.45.89.47-.89-1.57-.94.14-.71 1.76.26.21-.98-1.93-.29c-.07-.99-.41-1.42-.96-2.25C20.97 7.46 19 4.5 19 4.5c-2.4 0-4.81 2.57-5.67 3.59zm-3 3a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m6 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m-4 3h2l-.7 1.39c.2.64.76 1.11 1.45 1.11a1.5 1.5 0 0 0 1.5-1.5h.5a2 2 0 0 1-2 2c-.75 0-1.4-.41-1.75-1-.35.59-1 1-1.75 1a2 2 0 0 1-2-2h.5a1.5 1.5 0 0 0 1.5 1.5c.69 0 1.25-.47 1.45-1.11z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            zdd14990
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              第三章：双曲型方程的有限差分法
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="切换到暗色模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="切换到暗色模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="切换到亮色模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换到亮色模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/zdd14990/zdd14990.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    zdd14990
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  首页

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  博文

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E5%8F%8B%E9%93%BE/%E5%8F%8B%E9%93%BE/" class="md-tabs__link">
          
  
  
    
  
  友链

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="zdd14990" class="md-nav__button md-logo" aria-label="zdd14990" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 8-1.33.09C9.81 7.07 7.4 4.5 5 4.5c0 0-1.97 2.96-.04 6.91-.55.83-.89 1.26-.96 2.25l-1.93.29.21.98 1.76-.26.14.71-1.57.94.47.89 1.45-.89C5.68 18.76 8.59 20 12 20s6.32-1.24 7.47-3.68l1.45.89.47-.89-1.57-.94.14-.71 1.76.26.21-.98-1.93-.29c-.07-.99-.41-1.42-.96-2.25C20.97 7.46 19 4.5 19 4.5c-2.4 0-4.81 2.57-5.67 3.59zm-3 3a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m6 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m-4 3h2l-.7 1.39c.2.64.76 1.11 1.45 1.11a1.5 1.5 0 0 0 1.5-1.5h.5a2 2 0 0 1-2 2c-.75 0-1.4-.41-1.75-1-.35.59-1 1-1.75 1a2 2 0 0 1-2-2h.5a1.5 1.5 0 0 0 1.5 1.5c.69 0 1.25-.47 1.45-1.11z"/></svg>

    </a>
    zdd14990
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zdd14990/zdd14990.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    zdd14990
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    首页
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    博文
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    博文
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    分析
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    分析
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../catalog_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%88%86%E6%9E%902-H%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    分析2-H笔记
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%AE%9E%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    实分析
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%BE%AE%E5%88%86%E5%87%A0%E4%BD%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    微分几何
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    代数
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    代数
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../catalog_algebra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E4%BB%A3%E6%95%B02-H%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    代数2-H笔记
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E4%BA%A4%E6%8D%A2%E4%BB%A3%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    交换代数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%A1%A8%E7%A4%BA%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    表示论
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    应用数学
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    应用数学
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../catalog_applied/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4_2" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2" id="__nav_2_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    PDE 数值解
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    PDE 数值解
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PDE%20%E6%95%B0%E5%80%BC%E8%A7%A3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第零章:基本定义
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第一章:椭圆 PDE 的有限差分方法
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第二章:抛物 PDE 的有限差分法
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4_3" >
        
          
          <label class="md-nav__link" for="__nav_2_4_3" id="__nav_2_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    凸优化
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    凸优化
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%87%B8%E4%BC%98%E5%8C%96/%E5%87%B8%E4%BC%98%E5%8C%96/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%87%B8%E4%BC%98%E5%8C%96/chapter1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第一章:凸分析
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%87%B8%E4%BC%98%E5%8C%96/chapter2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第二章:凸多面体
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%87%B8%E4%BC%98%E5%8C%96/chapter3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第三章:凸优化
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%87%B8%E4%BC%98%E5%8C%96/chapter4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第四章:几何对偶框架
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%B8%90%E8%BF%9B%E5%88%86%E6%9E%90/%E6%B8%90%E8%BF%9B%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    渐进分析
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    经济学
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    经济学
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../catalog_econ/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E4%B8%AD%E7%BA%A7%E5%BE%AE%E8%A7%82%E7%BB%8F%E6%B5%8E%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    中级微观经济学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    友链
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    友链
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%8F%8B%E9%93%BE/%E5%8F%8B%E9%93%BE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    友链
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 一阶线性双曲型方程
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. 一阶线性双曲型方程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-characteristic-lines" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 特征线 (Characteristic lines)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-fdm-for-transport-equation" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 输运方程的有限差分法 (FDM for transport equation)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 数值耗散/色散 (修正方程分析)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. 波动方程与线性双曲型方程
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. 波动方程与线性双曲型方程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 模型方程
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-pde" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 PDE 形式
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 高维波动方程
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. 混合方程
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. 混合方程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 传统方法
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-trotter" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 算子分裂 / 乘积公式 / Trotter 公式
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. 非线性双曲守恒律*
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. 非线性双曲守恒律*">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 性质
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2 算法
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-godunov" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3 打破 Godunov 定理**
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  
  



  
  


<h1 id="_1">第三章：双曲型方程的有限差分法</h1>
<ul>
<li>线性双曲型偏微分方程 (PDEs)：输运方程 (transport equation)、波动方程 (wave equation)、特征线 (characteristic lines)。</li>
<li>线性混合方程：对流扩散方程 (advection-diffusion equation)、拟线性双曲型方程 (quasi-linear hyperbolic equation)。</li>
<li>双曲守恒律 (hyperbolic conservation laws)：通量 (flux)、总变差减小 (TVD)、激波 (shock wave)、Godunov 方法、ENO / WENO 格式、黎曼求解器 (Riemann solvers)。</li>
</ul>
<h2 id="1">1. 一阶线性双曲型方程</h2>
<h3 id="11-characteristic-lines">1.1 特征线 (Characteristic lines)</h3>
<p>考虑一个向量值函数 <span class="arithmatex">\(u(x,t):\mathbb{R}^{n}\times\mathbb{R}^{+}\rightarrow\mathbb{R}^{p}\)</span> 满足</p>
<div class="arithmatex">\[
\partial_{t}u+\sum A_{i}\partial_{x_{i}}u+Bu=\psi
\]</div>
<p>其中 <span class="arithmatex">\(A_{i}\)</span>, <span class="arithmatex">\(B\in\mathbb{R}^{p\times p}\)</span>，<span class="arithmatex">\(\psi:\mathbb{R}^{n}\times\mathbb{R}^{+}\rightarrow\mathbb{R}^{p}\)</span>。如果对于任意 <span class="arithmatex">\(\alpha=(\alpha_{1},\dots,\alpha_{p})\in\mathbb{R}^{p}\setminus\{0\}\)</span>，<span class="arithmatex">\(A=\sum_{i=1}^{p}\alpha_{i}A_{i}\)</span> 是实可对角化的，则称该 PDE 为双曲型的。</p>
<p>此外，如果 <span class="arithmatex">\(A\)</span> 具有互异的实特征值，则称该 PDE 为严格双曲型的。</p>
<p>对于二阶方程</p>
<div class="arithmatex">\[
\partial_{t}^{2}u+2\sum_{i=1}^{n}a_{i}\partial_{t}\partial_{x_{i}}u+b_{0}\partial_{t}u-\sum_{i,j=1}^{n}a_{ij}\partial_{x_{i}}\partial_{x_{j}}u+\sum_{i=1}^{n}b_{i}\partial_{x_{i}}u+cu=\psi.
\]</div>
<p>令 <span class="arithmatex">\(V=u\)</span>，<span class="arithmatex">\(V_{0}=\partial_{t}u\)</span>，<span class="arithmatex">\(V_{i}=\partial_{x_{i}}u\)</span> (<span class="arithmatex">\(i=1,\dots,n\)</span>)，则</p>
<div class="arithmatex">\[
\partial_{t}V-V_{0}=0
\]</div>
<div class="arithmatex">\[
\partial_{t}V_{0}+2\sum_{i=1}^{n}a_{i}\partial_{x_{i}}V_{0}-\sum_{i,j=1}^{n}a_{ij}\partial_{x_{j}}V_{i}+\sum_{i=1}^{n}b_{i}V_{i}+cV=\psi,
\]</div>
<div class="arithmatex">\[
\partial_{t}V_{j}-\partial_{x_{j}}V_{0}=0.
\]</div>
<p>我们考虑一维一阶线性双曲型方程</p>
<div class="arithmatex">\[
u:\mathbb{R}\times\mathbb{R}^{+}\rightarrow\mathbb{R}^{p}, \quad u_{t}+Au_{x}=0
\]</div>
<p>其中 <span class="arithmatex">\(A=R\Lambda R^{-1}\)</span>，<span class="arithmatex">\(\Lambda=\text{diag}(\lambda_{1},\dots,\lambda_{p})\)</span>，<span class="arithmatex">\(\lambda_{1}\le\dots\le\lambda_{p}\)</span>。令 <span class="arithmatex">\(w=R^{-1}u\)</span>，则</p>
<div class="arithmatex">\[
w_{t}+\Lambda w_{x}=0 \Rightarrow \partial_{t}w_{i}+\lambda_{i}\partial_{x_{i}}w_{i}=0.
\]</div>
<p>其特征线为 <span class="arithmatex">\(\frac{dx_{i}}{\lambda_{i}}=dt \Rightarrow x_{i}=\lambda_{i}t+C\)</span>。我们可以发现</p>
<div class="arithmatex">\[
\frac{d}{dt}w_{i}(x_{i}(t), t) = \partial_{t}w_{i}(x(t), t) + \partial_{x}w_{i}(x(t), t) x'(t) = 0.
\]</div>
<p>所以 <span class="arithmatex">\(w_{i}(x_{i}(t),t)\)</span> 是常数。因此对于任意 <span class="arithmatex">\(x, t\)</span>，有 <span class="arithmatex">\(w_{i}(x,t)=w_{i}(x-\lambda_{i}t,0)\)</span>。假设 <span class="arithmatex">\(R=(\xi^{1},\dots,\xi^{p})\)</span>，则 <span class="arithmatex">\(w_{i}=\eta^{i}u\)</span>。我们称 <span class="arithmatex">\(w_{i}\)</span> 为特征 <span class="arithmatex">\((\lambda_{i},\xi^{i})\)</span> 的黎曼不变量 (Riemann invariant)。那么</p>
<div class="arithmatex">\[
u(x,t)=Rw(x,t)=\sum\xi^{i}w_{i}(x,t)=\sum\xi^{i}w_{i}(x-\lambda_{i}t,0)=\sum_{i=1}^{p}\xi^{i}\eta^{i}u_{0}(x-\lambda_{i}t).
\]</div>
<p><strong>定义 1.</strong> 对于区域 <span class="arithmatex">\(\Omega\subseteq\mathbb{R}\times\mathbb{R}^{+}\)</span>，其<strong>依赖域 (dependence domain)</strong> 定义为</p>
<div class="arithmatex">\[
D(\Omega):=\{y\in\mathbb{R} \mid \exists\lambda_{i},(x,t)\in\Omega \text{ s.t. } y=x-\lambda_{i}t\};
\]</div>
<p>其<strong>影响域 (influence domain)</strong> 定义为</p>
<div class="arithmatex">\[
I(\Omega)=\{(x,t)\in\mathbb{R}\times\mathbb{R}^{+} \mid \exists\lambda_{i},(x^{\prime},t^{\prime})\in\Omega, t \ge t' \text{ s.t. } x=x^{\prime}-\lambda_{i}(t-t^{\prime})\};
\]</div>
<p>其<strong>决定域 (decision domain)</strong> 定义为</p>
<div class="arithmatex">\[
K(\Omega) = \{(x, t) \in \mathbb{R} \times \mathbb{R}^{+} \mid \forall \lambda_i, (x', t') \in \Omega, t' \le t \text{ s.t. } x=x'-\lambda_i(t-t')\}.
\]</div>
<p>这里 <span class="arithmatex">\(R^{-1}=(\eta^{1}, \dots, \eta^{p})^T\)</span>。</p>
<p><strong>例子：</strong></p>
<ol>
<li><span class="arithmatex">\(\Omega=\{(x_{0},t_{0})\}\)</span>，<span class="arithmatex">\(\lambda_{1}=1\)</span>，<span class="arithmatex">\(\lambda_{2}=-1\)</span>。则 <span class="arithmatex">\(D(\Omega)=\{x_{0}-t_{0},x_{0}+t_{0}\}\)</span>，<span class="arithmatex">\(I(\Omega) = \{(x, t) \mid x = x_0 \pm(t-t_0), t \ge t_0\}\)</span>，<span class="arithmatex">\(K(\Omega)=\Omega\)</span>。</li>
<li><span class="arithmatex">\(\Omega=[0,1]\times[0,1]\)</span>，<span class="arithmatex">\(\lambda_{1}=1\)</span>，<span class="arithmatex">\(\lambda_{2}=-1\)</span>。则 <span class="arithmatex">\(D(\Omega)=[-1,2]\)</span>。</li>
<li><span class="arithmatex">\(\Omega=\{(x_{1},0),(x_{2},0)\}\)</span>，<span class="arithmatex">\(\lambda=\pm1\)</span>。<span class="arithmatex">\(K(\Omega)=\{(\frac{x_{1}+x_{2}}{2},\frac{x_{2}-x_{1}}{2})\}\)</span>。</li>
<li><span class="arithmatex">\(\Omega=[0,1]\times\{0\}\)</span>，<span class="arithmatex">\(K(\Omega)=\{(x,t) \mid 0\le t\le\frac{1}{2}, t\le x\le1-t\}\)</span>。</li>
</ol>
<h3 id="12-fdm-for-transport-equation">1.2 输运方程的有限差分法 (FDM for transport equation)</h3>
<p>考虑输运方程的初边值问题</p>
<div class="arithmatex">\[
\begin{cases}
u_{t}+au_{x}=0,\\
u(x,0)=u_{0}(x), x\in[x_{L},x_{R}],\\
u(x_{L},t)=u_{L}(t), t&gt;0.
\end{cases}
\]</div>
<p>当 <span class="arithmatex">\(x-at\ge x_{L}\)</span> 时，<span class="arithmatex">\(u(x,t)=u(x-at,0)\)</span>；当 <span class="arithmatex">\(x-at&lt;x_{L}\)</span> 时，<span class="arithmatex">\(u(x,t)=u_{L}(t-\frac{x-x_{L}}{a})\)</span>。</p>
<p>令 <span class="arithmatex">\(\tau=\Delta t\)</span>，<span class="arithmatex">\(h=\frac{x_{R}-x_{L}}{N+1}\)</span>，<span class="arithmatex">\(U_{j}^{m}\approx u(x_{j},t_{m})\)</span>，<span class="arithmatex">\(x_{j}=x_{L}+jh\)</span>，<span class="arithmatex">\(t_{m}=m\tau\)</span>，我们有以下三种简单的格式：(<span class="arithmatex">\(\mu=\frac{a\tau}{h}\)</span>)</p>
<ul>
<li>(backward/后向) <span class="arithmatex">\(\frac{U_{j}^{m+1}-U_{j}^{m}}{\tau}+a\frac{U_{j}^{m}-U_{j-1}^{m}}{h}=0 \Rightarrow U_{j}^{m+1}=(1-\mu)U_{j}^{m}+\mu U_{j-1}^{m}\)</span> (1)</li>
<li>(forward/前向) <span class="arithmatex">\(\frac{U_{j}^{m+1}-U_{j}^{m}}{\tau}+a\frac{U_{j+1}^{m}-U_{j}^{m}}{h}=0 \Rightarrow U_{j}^{m+1}=(1+\mu)U_{j}^{m}-\mu U_{j+1}^{m}\)</span> (2)</li>
<li>(central/中心) <span class="arithmatex">\(\frac{U_{j}^{m+1}-U_{j}^{m}}{\tau}+a\frac{U_{j+1}^{m}-U_{j-1}^{m}}{2h}=0 \Rightarrow U_{j}^{m+1}=U_{j}^{m}+\frac{\mu}{2}(U_{j-1}^{m}-U_{j+1}^{m})\)</span> (3)</li>
</ul>
<p><strong>(1) <span class="arithmatex">\(L^{\infty}\)</span>-稳定性</strong></p>
<p>通过凸组合，可以证明如果 <span class="arithmatex">\(a&gt;0\)</span> 且 <span class="arithmatex">\(0&lt;\mu\le1\)</span>，则 (1) 是 <span class="arithmatex">\(L^{\infty}\)</span>-稳定的，(2)(3) 是 <span class="arithmatex">\(L^{\infty}\)</span>-不稳定的；
如果 <span class="arithmatex">\(a&lt;0\)</span> 且 <span class="arithmatex">\(-1\le\mu&lt;0\)</span>，则 (2) 是 <span class="arithmatex">\(L^{\infty}\)</span>-稳定的，(1)(3) 是 <span class="arithmatex">\(L^{\infty}\)</span>-不稳定的。</p>
<p><strong>C.F.L. (Courant-Friedrichs-Lewy) 条件:</strong> <span class="arithmatex">\(D(U_{j}^{m})\subseteq D_{h}(U_{j}^{m})\)</span></p>
<p>对于后向格式且 <span class="arithmatex">\(a &gt; 0\)</span>，数值依赖域为 <span class="arithmatex">\(D_{h}(U_{j}^{m})=\{x_{j-m},x_{j-m+1},\dots,x_{j}\}\)</span>。
解析依赖域为 <span class="arithmatex">\(D(U_{j}^{m})=\{x_{j}-at_{m}\}\)</span>。
为了使 <span class="arithmatex">\(D_{h}(U_{j}^{m})\supseteq D(U_{j}^{m})\)</span>，我们需要 <span class="arithmatex">\(x_{j-m}\le x_{j}-at_{m} \Rightarrow \mu\le1\)</span>。</p>
<p><strong>注:</strong>
1.  CFL 条件是 <span class="arithmatex">\(L^{\infty}\)</span>-稳定性的必要条件。
    如果存在某个 <span class="arithmatex">\(Q\in D(P)\)</span> 但 <span class="arithmatex">\(Q\notin D_{h}(P)\)</span>，则在 <span class="arithmatex">\(Q\)</span> 处改变初值会改变解析解，但不会改变数值解。所以数值解无法逼近解析解。
2.  CFL 条件不是充分条件。例如，中心格式满足 CFL 条件，但是是不稳定的。</p>
<p><strong>(2) <span class="arithmatex">\(L^{2}\)</span>-稳定性</strong></p>
<p>令 <span class="arithmatex">\(U_{j}^{m}=\lambda_{k}^{m}e^{ik\pi jh}\)</span>。
在 (1) 中，<span class="arithmatex">\(\lambda_{k}=1-\mu(1-e^{ik\pi h})\)</span>。当 <span class="arithmatex">\(0&lt;\mu\le1\)</span> 时 <span class="arithmatex">\(|\lambda_k| \le 1\)</span>，(1) 是稳定的；
在 (2) 中，<span class="arithmatex">\(\lambda_{k}=1+\mu(1-e^{ik\pi h})\)</span>。当 <span class="arithmatex">\(-1\le\mu&lt;0\)</span> 时，<span class="arithmatex">\(|\lambda_{k}|\le1\)</span>。
在 (3) 中，<span class="arithmatex">\(\lambda_{k}=1-i\mu \sin k\pi h\)</span>，(3) 是不稳定的。</p>
<p>接下来我们学习一些针对输运方程的常用格式。</p>
<p><strong>(i) 迎风格式 (Upwind scheme):</strong></p>
<p>（这里我们可以将 <span class="arithmatex">\(a\)</span> 改为某个函数 <span class="arithmatex">\(a(x,t)\)</span> 且 <span class="arithmatex">\(\mu_{j}^{m}=\frac{a(x_{j},t_{m})\tau}{h}\)</span>）</p>
<div class="arithmatex">\[
U_{j}^{m+1}=\begin{cases}
U_{j}^{m}-\mu_{j}^{m}(U_{j}^{m}-U_{j-1}^{m}), &amp; a(x_{j},t_{m})\ge0\\
U_{j}^{m}-\mu_{j}^{m}(U_{j+1}^{m}-U_{j}^{m}), &amp; a(x_{j},t_{m})\le0
\end{cases}
\]</div>
<div class="arithmatex">\[
=U_{j}^{m}-\frac{1}{2}(u_{j}^{m}+|u_{j}^{m}|)(U_{j}^{m}-U_{j-1}^{m})-\frac{1}{2}(u_{j}^{m}-|u_{j}^{m}|)(U_{j+1}^{m}-U_{j}^{m})
\]</div>
<div class="arithmatex">\[
=U_{j}^{m}-\frac{1}{2}u_{j}^{m}(U_{j+1}^{m}-U_{j-1}^{m})+\frac{1}{2}|u_{j}^{m}|(U_{j+1}^{m}-2U_{j}^{m}+U_{j-1}^{m}).
\]</div>
<p><strong>(ii) Lax-Friedrichs 格式</strong></p>
<div class="arithmatex">\[
\frac{U_{j}^{m+1}-\frac{1}{2}(U_{j+1}^{m}+U_{j-1}^{m})}{\tau}+a_{j}^{m}\frac{U_{j+1}^{m}-U_{j-1}^{m}}{h}=0
\]</div>
<div class="arithmatex">\[
\Rightarrow U_{j}^{m+1}=U_{j}^{m}-\mu_{j}^{m}(U_{j+1}^{m}-U_{j-1}^{m})+\frac{1}{2}(U_{j+1}^{m}-2U_{j}^{m}+U_{j-1}^{m}).
\]</div>
<p>局部截断误差 <span class="arithmatex">\(T=O(\tau+h^{2}+\frac{h^{2}}{\tau})\)</span>。所以它是条件相容的。</p>
<p><strong>TVD (总变差减小) 性质:</strong> <span class="arithmatex">\(TV(U^{m+1})\le TV(U^{m})\)</span>，其中 <span class="arithmatex">\(TV(U^{m})=\sum_{j=0}^{N-1}|U_{j+1}^{m}-U_{j}^{m}|\approx\int|\frac{\partial u}{\partial x}|dx\)</span> 是离散总变差。
该性质等价于单调格式或极值点数非增。</p>
<p>可以证明迎风格式和 LF 格式满足 TVD 性质。所以它们是 <span class="arithmatex">\(L^{2}\)</span>-稳定的（或 <span class="arithmatex">\(L^{1}\)</span>-稳定的）。</p>
<p><strong>定理 1 (Godnov 定理).</strong> 任何单调（或 TVD）线性格式至多是一阶精度的。</p>
<p><strong>(iii) Lax-Wendroff 格式</strong></p>
<p>通过泰勒公式，我们有</p>
<div class="arithmatex">\[
\frac{U_{j}^{m+1}-U_{j}^{m}}{\tau}+a\frac{U_{j}^{m}-U_{j-1}^{m}}{h}=-\frac{1}{2}[ahu_{xx}-\tau u_{tt}]_{j}^{m}+O(\tau^{2}+h^{2})
\]</div>
<div class="arithmatex">\[
=-\frac{1}{2}[ahu_{xx}-\tau a^{2}u_{xx}]_{j}^{m}+O(\tau^{2}+h^{2})
\]</div>
<div class="arithmatex">\[
=-\frac{1}{2}ah(1-\mu)[u_{xx}]_{j}^{m}+O(\tau^{2}+h^{2}).
\]</div>
<p>如果我们令 <span class="arithmatex">\([u_{xx}]_{j}^{m}\approx\frac{\delta_{x}^{2}U_{j}^{m}}{h^{2}}\)</span>，则得到 Lax-Wendroff 格式：</p>
<div class="arithmatex">\[
U_{j}^{m+1}=-\frac{1}{2}\mu(1-\mu)U_{j+1}^{m}+(1-\mu^{2})U_{j}^{m}+\frac{1}{2}\mu(1+\mu)U_{j-1}^{m}
\]</div>
<div class="arithmatex">\[
=U_{j}^{m}-\frac{1}{2}\mu(U_{j+1}^{m}-U_{j-1}^{m})+\frac{1}{2}\mu^{2}(U_{j+1}^{m}-2U_{j}^{m}+U_{j-1}^{m}). \quad (4)
\]</div>
<p>局部截断误差为 <span class="arithmatex">\(T=O(\tau^{2}+h^{2})\)</span>。我们有 <span class="arithmatex">\(\lambda_{k}=1-2\mu^{2}\sin^{2}\frac{kh}{2}-i\mu \sin kh\)</span>，所以 <span class="arithmatex">\(|\mu|\le1\)</span> 是其 <span class="arithmatex">\(L^{2}\)</span> 稳定性的条件。并且它不具有 <span class="arithmatex">\(L^{\infty}\)</span>-稳定性（会产生振荡）。</p>
<p><strong>(iv) Beam-Warming 格式</strong></p>
<p>如果我们令 <span class="arithmatex">\([u_{xx}]_{j}^{m}\approx\frac{\delta_{x}^{2}U_{j-1}^{m}}{h^{2}}\)</span> 在 (4) 中，则得到 Beam-Warming 格式：</p>
<div class="arithmatex">\[
U_{j}^{m+1}=\frac{1}{2}(1-\mu)(2-\mu)U_{j}^{m}+\mu(2-\mu)U_{j-1}^{m}-\frac{1}{2}\mu(1-\mu)U_{j-2}^{m}.
\]</div>
<p>局部截断误差也是 <span class="arithmatex">\(T=O(\tau^{2}+h^{2})\)</span>。我们有 <span class="arithmatex">\(\lambda_{k}=e^{-ikh}(1-2(1+\mu)^{2}\sin^{4}\frac{kh}{2}+i(1-\mu)\sin kh)\)</span>，所以 <span class="arithmatex">\(a&gt;0\)</span> 且 <span class="arithmatex">\(0\le\mu\le2\)</span> 是其 <span class="arithmatex">\(L^{2}\)</span>-稳定性的条件。并且它也不具有 <span class="arithmatex">\(L^{\infty}\)</span>-稳定性（振荡）。</p>
<p><strong>(v) Leap-frog (蛙跳) 格式</strong></p>
<div class="arithmatex">\[
\frac{U_{j}^{m+1}-U_{j}^{m-1}}{2\tau}+a\frac{U_{j+1}^{m}-U_{j-1}^{m}}{2h}=0
\]</div>
<p><span class="arithmatex">\(T=O(\tau^{2}+h^{2})\)</span>。
<span class="arithmatex">\(\lambda_{k}=\pm\sqrt{1-\mu^{2}\sin^{2}kh}-i\mu \sin kh\)</span>。
<span class="arithmatex">\(L^{2}\)</span>-稳定性: <span class="arithmatex">\(|\mu|\le1\)</span>。</p>
<h2 id="2">2. 数值耗散/色散 (修正方程分析)</h2>
<p>我们考虑一种特殊的行波解</p>
<div class="arithmatex">\[
u(x,t)=e^{i(kx-wt)}
\]</div>
<p>其中 <span class="arithmatex">\(w(k)\)</span> 是色散关系。例如，在 <span class="arithmatex">\(u_{t}+au_{x}=0\)</span> 中，<span class="arithmatex">\(w(k)=ak\)</span>；在 <span class="arithmatex">\(iu_{t}=-\frac{1}{2}u_{xx}\)</span> (薛定谔方程) 中，<span class="arithmatex">\(w(k)=\frac{1}{2}k^{2}\)</span>。</p>
<p>假设 <span class="arithmatex">\(w=w_{0}+iw_{1}\)</span>，则</p>
<div class="arithmatex">\[
e^{i(kx-wt)}=e^{w_{1}t}e^{ik(x-\frac{w_{0}}{k}t)}.
\]</div>
<p>我们定义位相位移为 <span class="arithmatex">\(w_{0}\)</span>，角/相速度为 <span class="arithmatex">\(c_{p}=\frac{w_{0}}{k}\)</span>。
回忆在 Von Neumann 分析中，<span class="arithmatex">\(U^{(k)m}=\lambda_{k}^{m}e^{ikx}\)</span>。则</p>
<div class="arithmatex">\[
\lambda_{k}e^{ikx}=e^{i(kx-wt)} \Rightarrow \lambda_{k}=e^{-iw\tau}=e^{w_{1}\tau}e^{-iw_{0}\tau}.
\]</div>
<p>所以这是高级傅里叶分析。我们有：</p>
<div class="arithmatex">\[
w_{0}=-\frac{\arg(\lambda_{k})}{\tau}, \quad w_{1}=\frac{1}{\tau}\ln|\lambda_{k}|.
\]</div>
<p>对于给定的 <span class="arithmatex">\(k_{0}\)</span>，令 <span class="arithmatex">\(k\)</span> 接近 <span class="arithmatex">\(k_{0}\)</span>，<span class="arithmatex">\(k=k_{0}+\Delta k, \Delta k\ll k_{0}\)</span>，则</p>
<div class="arithmatex">\[
v_{0}(k)=w_{0}(k_{0})+w_{0}^{\prime}(k_{0})(k-k_{0})+O((k-k_{0})^{2})
\]</div>
<div class="arithmatex">\[
\Rightarrow e^{i(kx-wt)}=e^{w_{1}t}e^{i(kx-w_{0}t)} \approx e^{w_{1}t}e^{ikx-it(w_{0}(k_{0})+w_{0}^{\prime}(k_{0})(k-k_{0}))} \approx e^{w_{1}t}e^{-iw_{0}(k_{0})t+iw_{0}^{\prime}(k_{0})k_{0}t}e^{ik(x-tw_{0}^{\prime}(k_{0}))}.
\]</div>
<p>项 <span class="arithmatex">\(e^{ik(x-tw_{0}^{\prime}(k_{0})}\)</span> 是唯一随 <span class="arithmatex">\(k\)</span> 变化的项。所以我们定义群速度为 <span class="arithmatex">\(c_{g}=w_{0}^{\prime}(k)\)</span>。</p>
<p>然后我们对一些数值格式进行耗散和色散分析。</p>
<p><strong>(1) 迎风格式</strong></p>
<p>通过傅里叶分析，我们有</p>
<div class="arithmatex">\[
\lambda_{k}=(1-|\mu|)+|\mu|e^{-i\text{sign}(a)kh}=1-|\mu|+|\mu|\cos kh-i\text{sign}(a)|\mu|\sin kh.
\]</div>
<p><strong>耗散分析:</strong> <span class="arithmatex">\(|\lambda_{k}|^{2}=1-4|\mu|(1-|\mu|)\sin^{2}\frac{kh}{2}\)</span>。
如果 <span class="arithmatex">\(kh\ll1\)</span>，则
<span class="arithmatex">\(|\lambda_{k}|\le1 \iff w_{1}\le0 \Rightarrow |\mu|\le1\)</span>。
<span class="arithmatex">\(|\lambda_{k}|^{2}\approx1-|\mu|(1-|\mu|)k^{2}h^{2} \Rightarrow w_{1}=\frac{1}{\tau}\ln|\lambda_{k}|\approx-\frac{1}{2\tau}|\mu|(1-|\mu|)k^{2}h^{2}\)</span>。
所以单步耗散为 <span class="arithmatex">\(e^{-w_{1}\tau}\approx1+O(k^{2}h^{2})\)</span>（<span class="arithmatex">\(|\mu|=|\frac{a\tau}{h}|=O(1)\)</span>）。对于固定时间 <span class="arithmatex">\(t_{max}\)</span>，我们需要 <span class="arithmatex">\(\frac{t_{max}}{\tau}\)</span> 步。所以长时间耗散为
<span class="arithmatex">\(e^{-w_{1}t_{max}}=(e^{-w_1\tau})^{\frac{t_{max}}{\tau}} \approx (1+O(h^2))^{\frac{1}{h}} \approx 1+O(h)\)</span>。
对于高频，如果 <span class="arithmatex">\(k\)</span> 增加，则 <span class="arithmatex">\(e^{-w_{1}\tau}\)</span> 增加且 <span class="arithmatex">\(|\lambda_{k}|\)</span> 减小。缺点是解会被过度平滑。</p>
<p><strong>色散分析:</strong>
对于 <span class="arithmatex">\(a\ge0\)</span>。
<span class="arithmatex">\(w_{0}\tau=-\arg(\lambda_{k})=-\arctan(\frac{\text{Im}(\lambda_{k})}{\text{Re}(\lambda_{k})})=\arctan(\frac{\text{sign}(a)|\mu|\sin kh}{1-|\mu|+|\mu|\cos kh})\)</span>
<span class="arithmatex">\(\Rightarrow w_{0}=\text{sign}(a)\frac{1}{\tau}\arctan(\frac{|\mu|\sin kh}{1-|\mu|+|\mu|\cos kh})\)</span>。
所以
当 <span class="arithmatex">\(|\mu|=1 \Rightarrow w_{0}=\frac{kh}{\tau}=ak\)</span>；
当 <span class="arithmatex">\(|\mu|=\frac{1}{2} \Rightarrow w_{0}=\frac{1}{\tau}\cdot\frac{kh}{2}=ak\)</span>；
当 <span class="arithmatex">\(|\mu|\ne1,\frac{1}{2} \Rightarrow w_{0}=ak(1-\frac{1}{6}(1-|\mu|)(1-2|\mu|)k^{2}h^{2}+o(k^{2}h^{2}))=ak(1-O(k^{2}h^{2}))\)</span>。</p>
<p><strong>(2) Lax-Wendroff</strong></p>
<p>通过傅里叶分析，我们有 <span class="arithmatex">\(\lambda_{k}=1-2\mu^{2}\sin^{2}\frac{kh}{2}-i\mu \sin kh\)</span>。</p>
<p><strong>耗散分析:</strong>
<span class="arithmatex">\(|\lambda_{k}|^{2}=1-4\mu^{2}(1-\mu^{2})\sin^{4}\frac{kh}{2}\)</span>
<span class="arithmatex">\(\Rightarrow |\lambda_{k}|\approx1-2\mu^{2}(1-\mu^{2})\sin^{4}\frac{kh}{2}\)</span>
<span class="arithmatex">\(\Rightarrow w_{1}=\frac{1}{\tau}\ln|\lambda_{k}|\approx-\frac{2\mu^{2}}{\tau}(1-\mu^{2})\sin^{4}\frac{kh}{2}=-\frac{2\mu a}{h}(1-\mu^{2})\sin^{4}\frac{kh}{2}=O(k^{4}h^{3})\)</span>
<span class="arithmatex">\(\Rightarrow e^{-w_{1}\tau}=1+O(k^{4}h^{4})\)</span>
对于长时间，<span class="arithmatex">\(e^{-w_{1}t_{max}}=(e^{-w_{1}\tau})^{\frac{t_{max}}{\tau}}\approx1+\frac{t_{max}}{\tau}O(k^{4}h^{4})=1+O(h^{3})\)</span>。</p>
<p><strong>色散分析:</strong>
<span class="arithmatex">\(w_{0}=-\frac{1}{\tau}\arg(\lambda_{k})=-\frac{1}{\tau}\arctan(\frac{\mu \sin kh}{1-2\mu^{2}\sin^{2}\frac{kh}{2}}) \approx ak(1-\frac{1}{6}(1-\mu^{2})k^{2}h^{2}+o(k^{2}h^{2}))\)</span>。
由于 <span class="arithmatex">\(1-\mu^{2}\ge0\)</span>，总是 <span class="arithmatex">\(w_{0}\le ak\)</span>（太小）。如果 <span class="arithmatex">\(k\)</span> 增加，则 <span class="arithmatex">\(|w_{0}-ak|\)</span> 增加，这是糟糕的。</p>
<p><strong>(3) Leap-frog</strong>
我们有 <span class="arithmatex">\(\lambda_{k}=\pm\sqrt{1-\mu^{2}\sin^{2}kh}-i\mu \sin kh\)</span>。
所以 <span class="arithmatex">\(\lambda_{k}^{+}\)</span> 是正确的因子。
<span class="arithmatex">\(-\frac{1}{\tau}\arg(\lambda_{k}^{\pm})=\pm ak(1-\frac{1}{6}(1-\mu^{2})k^{2}h^{2}+\dots)\)</span>。</p>
<p><strong>修正方程分析:</strong>
所有数值格式都可以通过泰勒级数转化为无限项的常微分方程 (ODEs)，即 <span class="arithmatex">\(\tilde{u}_{t}=\sum_{m=0}^{\infty}a_{m}\partial_{x}^{m}\tilde{u}\)</span>。
令 <span class="arithmatex">\(u=e^{i(kx-wt)}\)</span>，
<span class="arithmatex">\(-iw e^{i(kx-wt)}=\sum_{m=0}^{\infty}a_{m}(ik)^{m}e^{i(kx-wt)}\)</span>
<span class="arithmatex">\(\Rightarrow -iw=w_{1}-iw_{0}=\sum_{m=0}^{\infty}a_{m}(ik)^{m}\)</span>
<span class="arithmatex">\(\Rightarrow w_{1}=\sum_{m=0}^{\infty}(-1)^{m}a_{2m}k^{2m}, w_{0}=\sum_{m=0}^{\infty}(-1)^{m-1}a_{2m+1}k^{2m+1}\)</span>。</p>
<p>例如，在迎风格式中，我们有
<span class="arithmatex">\(u_{t}=-au_{x}+\frac{1}{2}ah(1-\mu)u_{xx}-\frac{1}{6}ah^{2}(1-\mu)(2-\mu)u_{xxx}+\dots\)</span>。
其修正方程为
一阶: <span class="arithmatex">\(u_{t}=-au_{x}\)</span>，且 <span class="arithmatex">\(T=O(\tau+h)\)</span>。
二阶: <span class="arithmatex">\(u_{t}=-au_{x}+\frac{1}{2}ah(1-\mu)u_{xx}, T=O(\tau^{2}+h^{2})\)</span>。
三阶: <span class="arithmatex">\(u_{t}=-au_{x}+\frac{1}{2}ah(1-\mu)u_{xx}-\frac{1}{6}ah^{2}(1-\mu)(2-\mu)u_{xxx}, T=O(\tau^{2}+h^{3})\)</span>。
以及
<span class="arithmatex">\(\begin{cases}w_{0}=ak-\frac{1}{6}a(1-\mu)(1-2\mu)k^{3}h^{2}+\dots\\ w_{1}=-\frac{1}{6}ah(1-\mu)k^{2}+\dots\end{cases}\)</span></p>
<p>在 Lax-Wendroff 中，<span class="arithmatex">\(\tilde{u}_{t}=-au_{x}-\frac{1}{6}ah^{2}(1-\mu^{2})u_{xxx}-\frac{1}{8}ah^{3}\mu(1-\mu^{2})u_{xxxx}+\dots\)</span>，我们可以得到
<span class="arithmatex">\(\begin{cases}w_{1}=-\frac{1}{8}a\mu(1-\mu^{2})k^{4}h^{3}+\dots\\ w_{0}=ak(1-\frac{1}{6}a(1-\mu^{2})k^{2}h^{2}+\dots)\end{cases}\)</span></p>
<p>通过计算 <span class="arithmatex">\(w_{1}\)</span>, <span class="arithmatex">\(w_{0}\)</span>, <span class="arithmatex">\(c_{p}\)</span>, <span class="arithmatex">\(c_{g}\)</span>，我们得到下表：</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: left;">advection (exact)</th>
<th style="text-align: left;">upwind</th>
<th style="text-align: left;">Lax-Wendroff</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><span class="arithmatex">\(w_{1}\)</span></td>
<td style="text-align: left;">0</td>
<td style="text-align: left;"><span class="arithmatex">\(-\frac{1}{2}a(1-\mu)k^{2}h\)</span></td>
<td style="text-align: left;"><span class="arithmatex">\(-\frac{1}{8}a\mu(1-\mu^{2})k^{4}h^{3}\)</span></td>
</tr>
<tr>
<td style="text-align: left;"><span class="arithmatex">\(w_{0}\)</span></td>
<td style="text-align: left;"><span class="arithmatex">\(ak\)</span></td>
<td style="text-align: left;"><span class="arithmatex">\(ak[1-\frac{1}{6}(1-\mu)(1-2\mu)k^{2}h^{2}]\)</span></td>
<td style="text-align: left;"><span class="arithmatex">\(ak[1-\frac{1}{6}a(1-\mu^{2})k^{2}h^{2}]\)</span></td>
</tr>
<tr>
<td style="text-align: left;"><span class="arithmatex">\(c_{p}\)</span></td>
<td style="text-align: left;"><span class="arithmatex">\(a\)</span></td>
<td style="text-align: left;"><span class="arithmatex">\(a[1-\frac{1}{6}(1-\mu)(1-2\mu)k^{2}h^{2}]\)</span></td>
<td style="text-align: left;"><span class="arithmatex">\(a[1-\frac{1}{6}a(1-\mu^{2})k^{2}h^{2}]\)</span></td>
</tr>
<tr>
<td style="text-align: left;"><span class="arithmatex">\(c_{g}\)</span></td>
<td style="text-align: left;"><span class="arithmatex">\(a\)</span></td>
<td style="text-align: left;"><span class="arithmatex">\(a[1-\frac{2}{3}(1-\mu)(1-2\mu)k^{2}h^{2}]\)</span></td>
<td style="text-align: left;"><span class="arithmatex">\(a[1-\frac{2}{3}a(1-\mu^{2})k^{2}h^{2}]\)</span></td>
</tr>
</tbody>
</table>
<p><strong>注:</strong>
1) 数值上，<span class="arithmatex">\(c_{p}\le c_{g}\)</span>。
2) 对于一阶或二阶格式，<span class="arithmatex">\(3(a-c_{p})=a-c_{g}\)</span>。这是因为在 <span class="arithmatex">\(\tilde{u}_{t}=\sum a_{m}\partial_{x}^{m}u\)</span> 中，<span class="arithmatex">\(a_{1}=a\)</span>，<span class="arithmatex">\(a_{2}\)</span> 是耗散，<span class="arithmatex">\(a_{3}\)</span> 是色散且 <span class="arithmatex">\(a_{3}\ne0\)</span>。</p>
<h2 id="3">3. 波动方程与线性双曲型方程</h2>
<h3 id="31">3.1 模型方程</h3>
<p>我们考虑</p>
<div class="arithmatex">\[
\begin{cases}
u_{tt}=a^{2}u_{xx}, x\in(0,1), t\ge0,\\
u(x,0)=u_{0}(x), u_{t}(x,0)=v_{0}(x)\\
u(0,t)=u(1,t)=0.
\end{cases}
\]</div>
<p>令 <span class="arithmatex">\(v=u_{t}\)</span>, <span class="arithmatex">\(w=-au_{x}\)</span>，向量形式为 <span class="arithmatex">\((\begin{smallmatrix}v\\ w\end{smallmatrix})_{t}+(\begin{smallmatrix}0&amp;a\\ a&amp;0\end{smallmatrix})(\begin{smallmatrix}v\\ w\end{smallmatrix})_{x}=0\)</span>。</p>
<p>解析解为</p>
<div class="arithmatex">\[
u(x,t)=\frac{1}{2}[u_{0}(x+at)+u_{0}(x-at)]+\frac{1}{2a}\int_{x-at}^{x+at}v_{0}(\xi)d\xi.
\]</div>
<p><strong>(1) 显式格式:</strong></p>
<div class="arithmatex">\[
\frac{U_{j}^{m+1}-2U_{j}^{m}+U_{j}^{m-1}}{\tau^{2}}=a^{2}\frac{U_{j+1}^{m}-2U_{j}^{m}+U_{j-1}^{m}}{h^{2}}, \quad \mu=\frac{a\tau}{h}.
\]</div>
<p>局部截断误差是 <span class="arithmatex">\(T=O(\tau^{2}+h^{2})\)</span>。对于 <span class="arithmatex">\(U^{1}\)</span>，我们有
<span class="arithmatex">\(u(x_{j},\tau)=u(x_{j},0)+\tau u_{t}(x_{j},0)+\frac{1}{2}\tau^{2}u_{tt}(x_{j},0)+O(\tau^{3})\)</span>
<span class="arithmatex">\(=u_{0}(x_{j})+\tau v_{0}(x_{j})+\frac{1}{2}\tau^{2}a^{2}\frac{1}{h^{2}}\delta_{x}^{2}u(x_{j},0)+O(\tau^{3}+\tau^{2}h^{2})\)</span>。
所以 <span class="arithmatex">\(\begin{cases}U_{j}^{0}=u_{0}(x_{j}),\\ U_{j}^{1}=U_{j}^{0}+\tau v_{0}(x_{j})+\frac{1}{2}\mu^{2}\delta_{x}^{2}U_{j}^{0}.\end{cases}\)</span>。</p>
<p>对于 Von Neumann 分析，<span class="arithmatex">\(\lambda_{k}^{2}-2\lambda_{k}+1=\lambda_{k}\mu^{2}(e^{ikh}+e^{-ikh}-2)\)</span>
<span class="arithmatex">\(\Rightarrow \lambda_{k}^{\pm}=1-2\mu^{2}\sin^{2}\frac{kh}{2}\pm2i\mu \sin\frac{kh}{2}\sqrt{1-\mu^{2}\sin^{2}\frac{kh}{2}}\)</span>。
当 <span class="arithmatex">\(\mu=\frac{a\tau}{h}\le1\)</span> 时，我们可以得到 <span class="arithmatex">\(|\lambda_{k}^{\pm}|^{2}=1\)</span>。（如果 <span class="arithmatex">\(\mu&gt;1\)</span>，则 <span class="arithmatex">\(|\lambda_{k}|&gt;1\)</span>，这是不稳定的。）并且
<span class="arithmatex">\(w_{0}=-\frac{\arg(\lambda_{k})}{\tau}=\pm ak(1-\frac{1}{24}(1-\mu^{2})k^{2}h^{2}+\dots)\)</span>。</p>
<p><strong>(2) 隐式格式与 <span class="arithmatex">\(\theta\)</span>-格式</strong></p>
<div class="arithmatex">\[
\frac{\delta_{t}^{2}U_{j}^{m}}{\tau^{2}}=a^{2}[\theta\frac{\delta_{x}^{2}U_{j}^{m+1}}{h^{2}}+(1-2\theta)\frac{\delta_{x}^{2}U_{j}^{m}}{h^{2}}+\theta\frac{\delta_{x}^{2}U_{j}^{m-1}}{h^{2}}]
\]</div>
<p>其中 <span class="arithmatex">\(\delta_{x}^{2}U_{j}^{m}:=U_{j+1}^{m}-2U_{j}^{m}+U_{j-1}^{m}, \delta_{t}^{2}U_{j}^{m}:=U_{j}^{m+1}-2U_{j}^{m}+U_{j}^{m-1}\)</span>。局部截断误差为 <span class="arithmatex">\(T=O(\tau^{2}+h^{2})\)</span>。
通过 Von Neumann 分析，稳定性条件为
如果 <span class="arithmatex">\(0\le\theta\le\frac{1}{4}\)</span>，则 <span class="arithmatex">\((1-4\theta)\mu^2 \le 1\)</span>；
如果 <span class="arithmatex">\(\frac{1}{4}&lt;\theta\le1\)</span>，则无条件稳定。
并且 <span class="arithmatex">\(w_{0}=-\frac{1}{\tau}\arg(\lambda_{k})=\pm ak[1-\frac{1}{24}(1+(12\theta-1)\mu^{2})k^{2}h^{2}+\dots]\)</span>。</p>
<h3 id="32-pde">3.2 PDE 形式</h3>
<p>我们考虑</p>
<div class="arithmatex">\[
\vec{u}_{t}+A\vec{u}_{x}=0
\]</div>
<p>如果 <span class="arithmatex">\(A=P\Lambda P^{-1}\)</span> 容易对角化，那么我们有 <span class="arithmatex">\(\vec{v}_{t}+\Lambda\vec{v}_{x}=0\)</span>，<span class="arithmatex">\(\vec{v}=P^{-1}\vec{u}\)</span>。但现在我们直接考虑差分。</p>
<p>Lax-Wendroff 格式是：</p>
<div class="arithmatex">\[
\vec{U}_{j}^{m+1}=\vec{U}_{j}^{m}-\tau A\frac{\vec{U}_{j+1}^{m}-\vec{U}_{j-1}^{m}}{2h}+\frac{1}{2}\tau^{2}A^{2}\frac{\vec{U}_{j+1}^{m}-2\vec{U}_{j}^{m}+\vec{U}_{j-1}^{m}}{h^{2}}
\]</div>
<p>Lax-Friedrichs 格式是：</p>
<div class="arithmatex">\[
\frac{\vec{U}_{j}^{m+1}-\frac{1}{2}(\vec{U}_{j+1}^{m}+\vec{U}_{j-1}^{m})}{\tau}+A\frac{\vec{U}_{j+1}^{m}-\vec{U}_{j-1}^{m}}{2h}=0.
\]</div>
<p>Leap-frog 格式是：</p>
<div class="arithmatex">\[
\begin{cases}\delta_{t}V_{j}^{m}+\mu\delta_{x}W_{j}^{m}=0\\ \delta_{t}W_{j+\frac{1}{2}}^{m+\frac{1}{2}}+\mu\delta_{x}V_{j+\frac{1}{2}}^{m+\frac{1}{2}}=0\end{cases}
\Rightarrow \begin{cases} \frac{V_{j}^{m+\frac{1}{2}}-V_{j}^{m-\frac{1}{2}}}{\tau} + a\frac{W_{j+\frac{1}{2}}^{m}-W_{j-\frac{1}{2}}^{m}}{h}=0 \\ \frac{W_{j+\frac{1}{2}}^{m+1}-W_{j+\frac{1}{2}}^{m}}{\tau} + a\frac{V_{j+1}^{m+\frac{1}{2}}-V_{j}^{m+\frac{1}{2}}}{h}=0 \end{cases}
\]</div>
<p><strong>迎风 (Courant-Issacson-Rees) 格式:</strong>
假设 <span class="arithmatex">\(P^{-1}AP=\text{diag}(\lambda_{1},\dots,\lambda_{n})\)</span>。对于所有 <span class="arithmatex">\(\lambda_{1}\le\dots\le\lambda_{n}\)</span>，令 <span class="arithmatex">\(\Lambda^{\pm}=\text{diag}(\lambda_{1}^{\pm},\dots,\lambda_{n}^{\pm})\)</span>。
<span class="arithmatex">\(\lambda_{k}^{\pm}=\frac{1}{2}(|\lambda_{k}|\pm\lambda_{k})\)</span>。
<span class="arithmatex">\(\lambda_{k}=\lambda_{k}^{+}-\lambda_{k}^{-}\)</span>, <span class="arithmatex">\(|\lambda_{k}|=\lambda_{k}^{+}+\lambda_{k}^{-}\)</span>, <span class="arithmatex">\(\Lambda=\Lambda^{+}-\Lambda^{-}\)</span>, <span class="arithmatex">\(|\Lambda|=\Lambda^{+}+\Lambda^{-}\)</span>。
<span class="arithmatex">\(A^{\pm}=P\Lambda^{\pm}P^{-1}\)</span>。则 <span class="arithmatex">\(A=A^{+}-A^{-}\)</span>。</p>
<p>CIR 格式是</p>
<div class="arithmatex">\[
U_{j}^{m+1}=\frac{\tau}{h}A^{-}U_{j+1}^{m}+(I-\frac{\tau}{h}|A|)U_{j}^{m}+\frac{\tau}{h}A^{+}U_{j-1}^{m}.
\]</div>
<p>特别地，如果 <span class="arithmatex">\(\lambda_{k}\ge0\)</span>，则 <span class="arithmatex">\(A^{+}=A\)</span>, <span class="arithmatex">\(A^{-}=0\)</span>，格式变为
<span class="arithmatex">\(U_{j}^{m+1}=(I-\frac{\tau}{h}A)U_{j}^{m}+\frac{\tau}{h}AU_{j-1}^{m}\)</span>。</p>
<h3 id="33">3.3 高维波动方程</h3>
<p>我们考虑二维问题 <span class="arithmatex">\(u_{tt}=a^{2}(u_{xx}+u_{yy})\)</span>。</p>
<p>显式格式是</p>
<div class="arithmatex">\[
\frac{\delta_{t}^{2}U_{j,k}^{m}}{\tau^{2}}=a^{2}(\frac{\delta_{x}^{2}U_{j,k}^{m}}{h_{x}^{2}}+\frac{\delta_{y}^{2}U_{j,k}^{m}}{h_{y}^{2}})
\]</div>
<div class="arithmatex">\[
\Rightarrow U_{j,k}^{m+1}=2(1-\mu_{x}^{2}-\mu_{y}^{2})U_{j,k}^{m}+\mu_{x}^{2}(U_{j+1,k}^{m}+U_{j-1,k}^{m})+\mu_{y}^{2}(U_{j,k+1}^{m}+U_{j,k-1}^{m})-U_{j,k}^{m-1}
\]</div>
<p><span class="arithmatex">\(L^{2}\)</span>-稳定性条件是 <span class="arithmatex">\(|\lambda_{k}|\le1 \Rightarrow \mu_{x},\mu_{y}\le\frac{1}{\sqrt{2}}\)</span>。</p>
<p><strong>注:</strong> 双曲型 PDEs 与抛物型 PDEs 有相同的麻烦。随着维度增加，对于显式格式，稳定性条件将变为 <span class="arithmatex">\(\mu\le\frac{1}{\sqrt{d}}\)</span>；对于隐式格式，单步线性系统的系数矩阵将越来越复杂。</p>
<p><strong>ADI (Alternative direct implicit):</strong></p>
<div class="arithmatex">\[
\frac{U_{j,k}^{m+1}-2U_{j,k}^{m}+U_{j,k}^{m-1}}{\tau^2} = a^2 \left[ \frac{\delta_x^2}{h_x^2}(U_{j,k}^{m+1}+U_{j,k}^{m-1}) + \frac{\delta_y^2}{h_y^2}(U_{j,k}^{m+1}+U_{j,k}^{m-1}) \right] \dots \text{(公式不完整)}
\]</div>
<p><strong>LOD (Local one-dimensional) / 算子分裂:</strong> 见下一节。</p>
<h2 id="4">4. 混合方程</h2>
<h3 id="41">4.1 传统方法</h3>
<p>我们考虑对流扩散方程 <span class="arithmatex">\(u_t + au_x = cu_{xx}\)</span>。
其中 <span class="arithmatex">\(au_{x}\)</span> 是对流项，<span class="arithmatex">\(cu_{xx}\)</span> 是扩散项。令 <span class="arithmatex">\(v(x,t)=u(x+at,t)\)</span>，则 <span class="arithmatex">\(v_{t}=cv_{xx}\)</span>。
时空网格比率为 <span class="arithmatex">\(\nu=\frac{a\tau}{h}\)</span>, <span class="arithmatex">\(\mu=\frac{c\tau}{h^{2}}\)</span>；<span class="arithmatex">\(Pe=\frac{ah}{c}=\frac{\nu}{\mu}\)</span>，其中 Pe 是佩克莱特数 (Péclet number)。</p>
<p><strong>(1) 显式格式:</strong></p>
<p><strong>(a) 中心差分</strong></p>
<div class="arithmatex">\[
\frac{U_{j}^{m+1}-U_{j}^{m}}{\tau}+a\frac{U_{j+1}^{m}-U_{j-1}^{m}}{2h}=c\frac{U_{j+1}^{m}-2U_{j}^{m}+U_{j-1}^{m}}{h^{2}}
\]</div>
<p>局部截断误差为 <span class="arithmatex">\(T=\mathcal{O}(\tau+h^{2})\)</span>。</p>
<p><span class="arithmatex">\(L^{\infty}\)</span>-稳定性: 通过凸组合，
<span class="arithmatex">\(U_{j}^{m+1}=(\mu-\frac{\nu}{2})U_{j+1}^{m}+(1-2\mu)U_{j}^{m}+(\mu+\frac{\nu}{2})U_{j-1}^{m}\)</span>。
所以条件是 <span class="arithmatex">\(0 &lt; \nu &lt; 2\mu &lt; 1\)</span> 且 <span class="arithmatex">\(Pe\le2\)</span>。</p>
<p><span class="arithmatex">\(L^{2}\)</span>-稳定性:
<span class="arithmatex">\(\lambda_{k}=1-2\mu(1-\cos kh)-i\nu \sin kh\)</span>。
<span class="arithmatex">\(|\lambda_{k}|^{2}\le1 \Leftrightarrow \nu^{2}\le2\mu\le1 \Leftrightarrow \mu\le\frac{1}{2}, \tau\le\frac{2c}{a^{2}}\)</span>。
这里 <span class="arithmatex">\(\nu^{2}\le2\mu\le1\)</span> 可以由 <span class="arithmatex">\(\mu\le\frac{1}{2}, Pe\le2\)</span> 证明。</p>
<p><strong>(b) Lax-Wendroff (修正中心差分)</strong></p>
<p>通过 <span class="arithmatex">\(u_{j}^{m+1}=[u+\tau u_{t}+\frac{1}{2}\tau^{2}u_{tt}]_{j}^{m}+\mathcal{O}(\tau^{3})=[u-a\tau u_{x}+c\tau u_{xx}+\frac{a^{2}\tau^{2}}{2}u_{xx}]_{j}^{m}+\mathcal{O}(c\tau^{2}+\tau^{3})\)</span>，
我们有</p>
<div class="arithmatex">\[
\frac{U_{j}^{m+1}-U_{j}^{m}}{\tau}+a\frac{U_{j+1}^{m}-U_{j-1}^{m}}{2h}=(c+\frac{1}{2}a^{2}\tau)\frac{U_{j+1}^{m}-2U_{j}^{m}+U_{j-1}^{m}}{h^{2}}
\]</div>
<p><span class="arithmatex">\(T=\mathcal{O}(c\tau+\tau^{2}+h^{2})\)</span>。
稳定性条件是
<span class="arithmatex">\(L^{2}: (c+\frac{1}{2}a^{2}\tau)\frac{\tau}{h^{2}}\le\frac{1}{2}, \tau\le\frac{2c+a^{2}\tau}{a^{2}}\)</span> (后者已满足)。
<span class="arithmatex">\(L^{\infty}: (c+\frac{1}{2}a^{2}\tau)\frac{\tau}{h^{2}}\le\frac{1}{2}, h\le\frac{2c+a^{2}\tau}{a}\)</span>。</p>
<p><strong>(c) 迎风</strong></p>
<p>对于 <span class="arithmatex">\(a&gt;0\)</span>，</p>
<div class="arithmatex">\[
\frac{U_{j}^{m+1}-U_{j}^{m}}{\tau}+a\frac{U_{j}^{m}-U_{j-1}^{m}}{h}=c\frac{U_{j+1}^{m}-2U_{j}^{m}+U_{j-1}^{m}}{h^{2}}
\]</div>
<div class="arithmatex">\[
\Leftrightarrow \frac{U_{j}^{m+1}-U_{j}^{m}}{\tau}+a\frac{U_{j+1}^{m}-U_{j-1}^{m}}{2h}=(c+\frac{1}{2}ah)\frac{U_{j+1}^{m}-2U_{j}^{m}+U_{j-1}^{m}}{h^{2}}.
\]</div>
<p>它可以看作是修正的中心差分。稳定性条件为
<span class="arithmatex">\(L^{2}: (c+\frac{1}{2}ah)\frac{\tau}{h^{2}}\le\frac{1}{2}, \tau\le\frac{2c+ah}{a^{2}}\)</span> (已满足)。
<span class="arithmatex">\(L^{\infty}: (c+\frac{1}{2}ah)\frac{\tau}{h^{2}}\le\frac{1}{2}, h\le\frac{2c+ah}{a}\)</span> (已满足)。</p>
<p><strong>(2) 隐式格式</strong></p>
<p><strong>(a) Crank-Nicolson</strong></p>
<div class="arithmatex">\[
\frac{U_{j}^{m+1}-U_{j}^{m}}{\tau}+\frac{a}{2}[\frac{U_{j+1}^{m}-U_{j-1}^{m}}{2h}+\frac{U_{j+1}^{m+1}-U_{j-1}^{m+1}}{2h}]=\frac{c}{2}[\frac{\delta_{x}^{2}U_{j}^{m}}{h^{2}}+\frac{\delta_{x}^{2}U_{j}^{m+1}}{h^{2}}]
\]</div>
<p><span class="arithmatex">\(L^2\)</span>: <span class="arithmatex">\(\lambda_k = \frac{1-\mu(1-\cos kh)-i\frac{\nu}{2}\sin kh}{1+\mu(1-\cos kh)+i\frac{\nu}{2}\sin kh}\)</span>，无条件稳定。</p>
<p><span class="arithmatex">\(L^\infty\)</span>: <span class="arithmatex">\((1+\mu)U_j^{m+1} = (1-\mu)U_j^m + (\frac{\mu}{2}-\frac{\nu}{4})U_{j+1}^m + (\frac{\mu}{2}+\frac{\nu}{4})U_{j-1}^m + \dots\)</span>
条件: <span class="arithmatex">\(\mu\le1, h\le\frac{2c}{a}\)</span> (<span class="arithmatex">\(Pe\le2\)</span>)。</p>
<h3 id="42-trotter">4.2 算子分裂 / 乘积公式 / Trotter 公式</h3>
<p>我们考虑方程形式 <span class="arithmatex">\(u_{t}=Au+Bu\)</span>，其中 A, B 是微分算子。例如，
(对流扩散方程) <span class="arithmatex">\(u_{t}+au_{x}=cu_{xx}\)</span>，则 <span class="arithmatex">\(A=-a\partial_{x}, B=c\partial_{x}^{2}\)</span>。
(薛定谔方程) <span class="arithmatex">\(iu_{t}=-\Delta u+V(x)u\)</span>，则 <span class="arithmatex">\(A=i\Delta, B=-iV(x)\)</span>。
(一般形式) <span class="arithmatex">\(\partial_{t}u+\sum_{l=1}^{d}C_{l}\partial_{x_{l}}u=0\)</span>，则 <span class="arithmatex">\(A_{l}=-C_{l}\partial_{x_{l}}\)</span>。</p>
<p>为简单起见，假设 A, B 与时间无关。（如果它们与时间有关，我们可以使用 Dyson 级数代替泰勒级数。）所以 <span class="arithmatex">\(\partial_{t}Au=Au_{t}, \partial_{t}Bu=Bu_{t} \Rightarrow \partial_{t}^{k}u=(A+B)^{k}u\)</span>。</p>
<p>通过泰勒级数，
<span class="arithmatex">\(u(x,t)=\sum_{k=0}^{\infty}\frac{t^{k}}{k!}\partial_{t}^{k}u(x,0)=\sum_{k=0}^{\infty}\frac{t^{k}}{k!}(A+B)^{k}u(x,0)=\exp((A+B)t)u(x,0)\)</span>。
<span class="arithmatex">\(e^{(A+B)\tau}=I+(A+B)\tau+\frac{1}{2}(A^{2}+AB+BA+B^{2})\tau^{2}+\mathcal{O}(\tau^{3})\)</span>。
对于 <span class="arithmatex">\(\tau\ll1\)</span>，直观上我们有 <span class="arithmatex">\(e^{(A+B)\tau}\approx e^{B\tau}e^{A\tau}\)</span>。我们分析其误差：
<span class="arithmatex">\(e^{B\tau}e^{A\tau}=(I+B\tau+\frac{1}{2}B^{2}\tau^{2}+\mathcal{O}(\tau^{3}))(I+A\tau+\frac{1}{2}A^{2}\tau^{2}+\mathcal{O}(\tau^{3}))=I+(A+B)\tau+\frac{1}{2}(B^{2}+A^{2}+2BA)\tau^{2}+\mathcal{O}(\tau^{3})\)</span>。
<span class="arithmatex">\(\Rightarrow e^{(A+B)\tau}-e^{B\tau}e^{A\tau}=\frac{1}{2}[A,B]\tau^{2}+\mathcal{O}(\tau^{3}), [A,B]=AB-BA\)</span>。</p>
<p>对于 <span class="arithmatex">\(t_{max}\)</span> 和 <span class="arithmatex">\(m=\frac{t_{max}}{\tau}\)</span>，我们有
<span class="arithmatex">\(\Rightarrow ||e^{(A+B)\tau}-e^{B\tau}e^{A\tau}||\le C\tau^{2}||[A,B]||\)</span>。
<span class="arithmatex">\(||e^{(A+B)t_{max}}-(e^{B\tau}e^{A\tau})^{m}||\le m\cdot C\tau^{2}||[A,B]||=t_{max}\tau\cdot C||[A,B]||\)</span>。</p>
<p>我们有二阶 Trotter/Strang 分裂：
<span class="arithmatex">\(||e^{(A+B)\tau}-e^{\frac{1}{2}A\tau}e^{B\tau}e^{\frac{1}{2}A\tau}||\le\frac{1}{2}\tau^{3}(||A||+||B||)^{3}+\mathcal{O}(\tau^{4})\)</span>。</p>
<p>以及 Trotter-Suzuki 公式：
<span class="arithmatex">\(U_{2}(\tau)=e^{\frac{1}{2}A\tau}e^{B\tau}e^{\frac{1}{2}A\tau}\)</span>，
<span class="arithmatex">\(U_{2k}(\tau)=U_{2k-2}^{2}(s_{k}\tau)U_{2k-2}((1-4s_{k})\tau)U_{2k-2}^{2}(s_{k}\tau)\)</span>，其中 <span class="arithmatex">\(s_{k}=1/(4-4^{\frac{1}{2k-1}})\)</span>，
<span class="arithmatex">\(||e^{(A+B)\tau}-U_{2k}(\tau)||=\mathcal{O}(\tau^{2k+1})\)</span>。</p>
<p>例如，求解 <span class="arithmatex">\(u_{t}+au_{x}=cu_{xx}\)</span>，我们有
<span class="arithmatex">\(\begin{cases}U_{j}^{m*}=U_{j}^{m}-\frac{a\tau}{h}(U_{j}^{m}-U_{j-1}^{m}),\\ U_{j+1}^{m+1}=U_{j}^{m*}+\frac{c\tau}{h^{2}}(U_{j+1}^{m*}-2U_{j}^{m*}+U_{j-1}^{m*}).\end{cases}\)</span></p>
<p>误差分析包括两部分：
<span class="arithmatex">\(||e^{(A+B)t_{m}}-(e^{B\tau}e^{A\tau})^{m}||+||(e^{B\tau}e^{A\tau})^{m}-((I+B\tau)(I+A\tau))^{m}||\)</span>。</p>
<h2 id="5">5. 非线性双曲守恒律*</h2>
<h3 id="51">5.1 性质</h3>
<p>我们考虑</p>
<div class="arithmatex">\[
u_{t}+[f(u)]_{x}=0
\]</div>
<p>所以 <span class="arithmatex">\(u_{t}+a(u)u_{x}=0\)</span>, <span class="arithmatex">\(a(u)=f^{\prime}(u)\)</span>。</p>
<p>其特征线是 <span class="arithmatex">\(\frac{dx}{dt}=a(u) \Rightarrow x(t)=a(u)t+x(0)\)</span>。那么 <span class="arithmatex">\(\frac{d}{dt}(u(x(t),t))=u_{x}\cdot\frac{dx}{dt}+u_{t}=0\)</span>。
<span class="arithmatex">\(u(x(t),t)=u(x(0),0)=u_{0}(x(0))\)</span>。<span class="arithmatex">\(x(t)=x(0)+a(u_{0}(x(0)))t\)</span>。</p>
<p>例如，我们考虑无粘 Burgers 方程 (一维 Euler 方程) <span class="arithmatex">\(u_{t}+uu_{x}=0\)</span>。
<span class="arithmatex">\(u_{0}(x)=\begin{cases}1,&amp;x&lt;-1,\\ -x,&amp;-1\le x\le0,\\ 0,&amp;x&gt;0.\end{cases}\)</span></p>
<p>通过 <span class="arithmatex">\(x(t)=x_{0}+a(u_{0}(x_{0}))t=x_{0}+u_{0}(x_{0})t\)</span>，我们有特征线的图：
<span class="arithmatex">\(u(x,t)\)</span> 的值在每条特征线上是常数，所以 <span class="arithmatex">\(u(x,t)\)</span> 从 <span class="arithmatex">\(u_{0}\)</span> 沿着特征线演化。
因为 (0,1) 是 <span class="arithmatex">\(x_{0}\in[-1,0]\)</span> 的特征线的交点，所以对于 <span class="arithmatex">\(t\ge1\)</span>，<span class="arithmatex">\(u(x,t)\)</span> 没有经典解，并且在 (0,1) 处存在激波。</p>
<p><strong>定义 2 (弱解).</strong> 对于方程 <span class="arithmatex">\(u_{t}+f^{\prime}(u)u_{x}=0\)</span>，其弱解定义为
(1) <span class="arithmatex">\(\forall x_{L}\)</span>, <span class="arithmatex">\(\int_{x_{L}}^{x_{R}}(u_{t}+f^{\prime}(u)u_{x})dx=0 \Rightarrow \frac{d}{dt}\int_{x_{L}}^{x_{R}}u(x,t)dx+f(u(x_{R},t))-f(u(x_{L},t))=0\)</span>。
(2) 测试函数 <span class="arithmatex">\(\phi\in C^{1}(\mathbb{R}^{2})\)</span> 具有紧支集，<span class="arithmatex">\(\int_{\mathbb{R}^{+}}\int_{\mathbb{R}}\phi(u_{t}+f^{\prime}(u)u_{x})dxdt=0 \Rightarrow \int_{\mathbb{R}^{+}}\int_{\mathbb{R}}(\phi_{t}u+\phi_{x}f(u))dxdt+\int_{\mathbb{R}}\phi(x,0)u(x,0)dx=0\)</span>。
这里 (1) 和 (2) 是等价的。</p>
<p>特征线的导数可以计算为
<span class="arithmatex">\(\frac{dx}{dt}=\lim_{x_{R}\rightarrow x^{+}}\frac{f(u(x_{R},t))-f(u(x_{L},t))}{u(x_{R},t)-u(x_{L},t)}\approx f^{\prime}(u(x,t))=a(u)\)</span>。
所以在上述无粘 Burgers 方程的例子中，<span class="arithmatex">\(\frac{dx}{dt}(0,1)=\lim_{x_{R}\rightarrow x^{-}}\frac{1}{2}(u(x_{R},t)+u(x_{L},t))=\frac{1}{2}\)</span>。</p>
<p>弱解是 (对于 <span class="arithmatex">\(t\ge1\)</span>)
<span class="arithmatex">\(u(x,t)=\begin{cases}1,&amp;x&lt;\frac{1}{2}t-\frac{1}{2},\\ 0,&amp;x&lt;\frac{1}{2}t-\frac{1}{2}.\end{cases}\)</span>
图为：在线 <span class="arithmatex">\(t=2x+1\)</span> 上，两类特征线相交。</p>
<p>如果 <span class="arithmatex">\(u_{0}(x)=\begin{cases}1,&amp;x&lt;0,\\ 0,&amp;x\ge0\end{cases}\)</span>，那么它的弱解是 <span class="arithmatex">\(u(x,t)=\begin{cases}1,&amp;x&lt;\frac{t}{2},\\ 0,&amp;x&gt;\frac{t}{2},\\ \frac{1}{2},&amp;x=\frac{t}{2}.\end{cases}\)</span></p>
<p>如果 <span class="arithmatex">\(u_{0}(x)=\begin{cases}0,&amp;x&lt;0,\\ 1,&amp;x\ge0\end{cases}\)</span>，那么它的弱解可以是 <span class="arithmatex">\(u(x,t)=\begin{cases}0,&amp;x&lt;\frac{t}{2},\\ 1,&amp;x&gt;\frac{t}{2},\\ \frac{1}{2},&amp;x=\frac{t}{2}.\end{cases}\)</span>。但这还不够好，因为它不满足熵解。</p>
<p><strong>定义 3.</strong> 对于解 <span class="arithmatex">\(u(x,t)\)</span>，如果
<span class="arithmatex">\(\lim_{x_{L}\rightarrow x^{-}}\frac{f(u(x,t))-f(u(x_{L},t))}{u(x,t)-u(x_{L},t)}\ge\frac{dx}{dt}(x,t)\ge \lim_{x_{R}\rightarrow x^{+}}\frac{f(u(x,t))-f(u(x_{R},t))}{u(x,t)-u(x_{R},t)}\)</span>，
则它满足熵条件。</p>
<p>令 <span class="arithmatex">\(u(x,t)=\begin{cases}0,&amp;x\le0,\\ \frac{x}{t},&amp;0&lt;x&lt;t,\\ 1,&amp;x\ge t.\end{cases}\)</span>。
这是一个满足熵条件的解。它被称为自相似解。</p>
<p><strong>定理 2.</strong> 对于方程 <span class="arithmatex">\(u_{t}+(f(u))_{x}=0\)</span>，<span class="arithmatex">\(u_0(x) = \begin{cases} u_L, &amp; x&lt;0 \\ u_R, &amp; x&gt;0 \end{cases}\)</span>。
如果 f(u) 是凸的，那么我们有
(i) (稀疏波 rarefaction wave) 如果 <span class="arithmatex">\(u_{L}&lt;u_{R}\)</span>，则
<span class="arithmatex">\(u(x,t)=\begin{cases}u_{L},&amp;x&lt;f^{\prime}(u_{L})t,\\ w(\frac{x}{t}),&amp;f^{\prime}(u_{L})t\le x\le f^{\prime}(u_{R})t,\\ u_{R},&amp;x&gt;f^{\prime}(u_{R})t,\end{cases}\)</span>
其中 <span class="arithmatex">\(w=(f^{\prime})^{-1}\)</span>。
(ii) (激波 shock wave) 如果 <span class="arithmatex">\(u_{L}&gt;u_{R}\)</span>，则
<span class="arithmatex">\(u(x,t)=\begin{cases}u_{L},&amp;x&lt;\frac{f(u_{L})-f(u_{R})}{u_{L}-u_{R}}t,\\ u_{R},&amp;x&gt;\frac{f(u_{L})-f(u_{R})}{u_{L}-u_{R}}t,\end{cases}\)</span>
我们发现凸或凹的 f 可以保证 <span class="arithmatex">\(w=(f^{\prime})^{-1}\)</span> 的存在。对于非凸非凹的 f，解可以通过凸松弛方法构造。</p>
<h3 id="52">5.2 算法</h3>
<p><strong>(1) 非守恒格式:</strong> 考虑迎风格式 <span class="arithmatex">\(U_{j}^{m+1}=U_{j}^{m}-\frac{\tau}{h}(U_{j}^{m}(U_{j}^{m}-U_{j-1}^{m}))\)</span>，<span class="arithmatex">\(U_{j}^{0}=\begin{cases}1,&amp;j&lt;0,\\ 0,&amp;j\ge0.\end{cases}\)</span>。
那么 <span class="arithmatex">\(U_{j}^{m+1}=U_{j}^{m}=\dots=U_{j}^{0}\)</span>。这不是正确的解。</p>
<p><strong>(2) 通量守恒格式:</strong> 在 <span class="arithmatex">\([x_{j-\frac{1}{2}},x_{j+\frac{1}{2}}]\times[t_{m},t_{m+1}]\)</span> 上积分 <span class="arithmatex">\(u_{t}+(\frac{1}{2}u^{2})_{x}=0\)</span>，我们有
<span class="arithmatex">\(\int_{x_{j-\frac{1}{2}}}^{x_{j+\frac{1}{2}}}(u(x,t_{m+1})-u(x,t_{m}))dx+\int_{t_{m}}^{t_{m+1}}(f(u(x_{j+\frac{1}{2}},t))-f(u(x_{j-\frac{1}{2}},t)))dt=0\)</span>。
令 <span class="arithmatex">\(\overline{U}_{j}^{m}=\frac{1}{h}\int_{x_{j-\frac{1}{2}}}^{x_{j+\frac{1}{2}}}u(x,t_{m})dx\)</span>, <span class="arithmatex">\(\overline{f}_{j+\frac{1}{2}}^{m+\frac{1}{2}}=\frac{1}{\tau}\int_{t_{m}}^{t_{m+1}}f(u(x_{j+\frac{1}{2}},t))dt\)</span>，
则 <span class="arithmatex">\(\overline{U}_{j}^{m+1}=\overline{U}_{j}^{m}-\frac{\tau}{h}(\overline{f}_{j+\frac{1}{2}}^{m+\frac{1}{2}}-\overline{f}_{j-\frac{1}{2}}^{m+\frac{1}{2}})\)</span>
<span class="arithmatex">\(\Rightarrow U_{j}^{m+1}=U_{j}^{m}-\frac{\tau}{h}(F_{j+\frac{1}{2}}^{m+\frac{1}{2}}-F_{j-\frac{1}{2}}^{m+\frac{1}{2}})\)</span>
其中 <span class="arithmatex">\(F_{j+\frac{1}{2}}=F(U_{j}^{m},U_{j+1}^{m})\approx\overline{f}_{j+\frac{1}{2}}^{m+\frac{1}{2}}\)</span> 是数值通量。
离散守恒律为 <span class="arithmatex">\(\sum_{j\in\mathbb{Z}}U_{j}^{m+1}=\sum_{j\in\mathbb{Z}}U_{j}^{m}\)</span>。</p>
<p><strong>(a) Roe 迎风格式:</strong>
令 <span class="arithmatex">\(a_{j+\frac{1}{2}}^{m}=\begin{cases}\frac{f(U_{j+1}^{m})-f(U_{j}^{m})}{U_{j+1}^{m}-U_{j}^{m}},&amp;U_{j}^{m}\ne U_{j+1}^{m},\\ 0,&amp;U_{j}^{m}=U_{j+1}^{m},\end{cases}\)</span>
<span class="arithmatex">\(F_{j+\frac{1}{2}}^{m+\frac{1}{2}}=\begin{cases}f(U_{j}^{m}),&amp;a_{j+\frac{1}{2}}^{m}\ge0,\\ f(U_{j+1}^{m}),&amp;a_{j+\frac{1}{2}}^{m}&lt;0.\end{cases}\)</span>
如果 <span class="arithmatex">\(a_{j+\frac{1}{2}}^{m}\ge0\)</span> 总是成立，则 <span class="arithmatex">\(U_{j}^{m+1}=U_{j}^{m}-\frac{\tau}{h}(f(U_{j}^{m})-f(U_{j-1}^{m}))\)</span>。</p>
<p><strong>(b) Lax-Friedrichs 格式</strong>
<span class="arithmatex">\(U_{j}^{m+1}=\frac{U_{j-1}^{m}+U_{j+1}^{m}}{2}-\frac{\tau}{2h}[f(U_{j+1}^{m})-f(U_{j-1}^{m})]\)</span>，
<span class="arithmatex">\(F_{j+\frac{1}{2}}^{m+\frac{1}{2}}=\frac{1}{2}(f(U_{j+1}^{m})+f(U_{j}^{m}))-\frac{h}{2\tau}(U_{j+1}^{m}-U_{j}^{m})\)</span>。</p>
<p><strong>(c) Lax-Wendroff 格式</strong>
通过 <span class="arithmatex">\(U_{j}^{m+1}=[u+\tau u_{t}+\frac{1}{2}\tau^{2}u_{tt}]_{j}^{m}+\mathcal{O}(\tau^{3})=[u-\tau(f(u))_{x}+\frac{1}{2}\tau^{2}(f^{\prime}(u)(f(u))_{x}]_{j}^{m}+\mathcal{O}(\tau^{3})\)</span>，
我们令 <span class="arithmatex">\(a_{j+\frac{1}{2}}^{m}=f^{\prime}(\frac{1}{2}(U_{j}^{m}+U_{j+1}^{m}))\approx\frac{f(U_{j+1}^{m})-f(U_{j}^{m})}{U_{j+1}^{m}-U_{j}^{m}}\)</span>，则有
<span class="arithmatex">\(U_{j}^{m+1}=U_{j}^{m}-\frac{\tau}{2h}(f(U_{j+1}^{m})-f(U_{j-1}^{m}))+\frac{\tau^{2}}{2h^{2}}[a_{j+\frac{1}{2}}^{m}(f(U_{j+1}^{m})-f(U_{j}^{m}))-a_{j-\frac{1}{2}}^{m}(f(U_{j}^{m})-f(U_{j-1}^{m}))]\)</span>。</p>
<p><strong>(d) Godunov 格式</strong>
在 <span class="arithmatex">\(U_{j}^{m+1}=U_{j}^{m}-\frac{\tau}{h}(F_{j+\frac{1}{2}}^{m+\frac{1}{2}}-F_{j-\frac{1}{2}}^{m+\frac{1}{2}})\)</span> 中，
我们令 <span class="arithmatex">\(F_{j+\frac{1}{2}}^{m+\frac{1}{2}}=f(u_{*}(U_{j}^{m},U_{j+1}^{m}))\)</span>。
<span class="arithmatex">\(u_{*}(U_{j}^{m},U_{j+1}^{m}) = w(0, U_j^m, U_{j+1}^m)\)</span>，
其中 <span class="arithmatex">\(w(\frac{x}{t},u_{L},u_{R})\)</span> 是黎曼问题 <span class="arithmatex">\(u(x,0)=\begin{cases}u_{L},&amp;x&lt;0,\\ u_{R},&amp;x&gt;0.\end{cases}\)</span> 的解。</p>
<p>假设 f 是凸的。那么我们有两种情况：
1) 如果 <span class="arithmatex">\(U_{j}^{m}&gt;U_{j+1}^{m}\)</span>，则由定理 2，存在激波。
我们有 <span class="arithmatex">\(u_{*}(U_{j}^{m},U_{j+1}^{m})=\begin{cases}U_{j}^{m},&amp;f(U_{j}^{m})&gt;f(U_{j+1}^{m}),\\ U_{j+1}^{m},&amp;f(U_{j}^{m})&lt;f(U_{j+1}^{m}).\end{cases}\)</span>
2) 如果 <span class="arithmatex">\(U_{j}^{m}&lt;U_{j+1}^{m}\)</span>，则由定理 2，存在稀疏波。我们有
<span class="arithmatex">\(u_{*}(U_{j}^{m},U_{j+1}^{m})=\begin{cases}U_{j}^{m},&amp;f^{\prime}(U_{j}^{m})&gt;0,\\ U_{j+1}^{m},&amp;f^{\prime}(U_{j+1}^{m})&lt;0,\\ u_{*},&amp;f^{\prime}(U_{j}^{m})&lt;0&lt;f^{\prime}(U_{j+1}^{m}),\end{cases}\)</span>
其中 <span class="arithmatex">\(u_{*}=(f^{\prime})^{-1}(0)\)</span>。</p>
<p>我们可以写出一个统一的公式：
<span class="arithmatex">\(F_{j+\frac{1}{2}}^{m+\frac{1}{2}}=\begin{cases} \min_{z\in[U_{j}^{m},U_{j+1}^{m}]}f(z), &amp; U_{j}^{m}&lt;U_{j+1}^{m}, \\ \max_{z\in[U_{j+1}^{m},U_{j}^{m}]}f(z), &amp; U_{j}^{m}&gt;U_{j+1}^{m}. \end{cases}\)</span></p>
<p><strong>(e) Engquist-Osher 格式 (通量分裂)</strong>
考虑到 Godunov 格式太复杂，我们简化 Godunov 格式并使用通量
<span class="arithmatex">\(F_{j+\frac{1}{2}}^{m+\frac{1}{2}}=f^{+}(U_{j}^{m})+f^{-}(U_{j+1}^{m})\)</span>，
<span class="arithmatex">\(\begin{cases}f^{+}(u)=\int_{0}^{u}\max\{f^{\prime}(u),0\}du+f(0),\\ f^{-}(u)=\int_{0}^{u}\min\{f^{\prime}(u),0\}du.\end{cases}\)</span>
值得一提的是，当 <span class="arithmatex">\(f^{\prime}(u)=a(u)\ge0\)</span> 总是成立时，Godunov 和 Engquist-Osher 格式中的 <span class="arithmatex">\(F_{j+\frac{1}{2}}^{m+\frac{1}{2}}\)</span> 将变为 <span class="arithmatex">\(f(U_{j}^{m})\)</span>。所以如果 <span class="arithmatex">\(a(u)\ge0\)</span>，Godunov, Roe, LF, EO 四种格式都将变成迎风格式 <span class="arithmatex">\(U_{j}^{m+1}=U_{j}^{m}-\frac{\tau}{h}(f(U_{j}^{m})-f(U_{j-1}^{m}))\)</span>。
Roe, LF, EO 都是简化的 Godunov 格式。</p>
<p><strong>定义 4.</strong> 对于 <span class="arithmatex">\(U_{j}^{m+1}=U_{j}^{m}-\frac{\tau}{h}(F_{j+\frac{1}{2}}^{m+\frac{1}{2}}-F_{j-\frac{1}{2}}^{m+\frac{1}{2}}):=H(U_{j-1}^{m},U_{j}^{m},U_{j+1}^{m})\)</span>。
如果 <span class="arithmatex">\(\forall v_{i}\ge u_{i}\)</span>, <span class="arithmatex">\(H(v_{1},v_{2},v_{3})\ge H(u_{1},u_{2},u_{3})\)</span>，则称格式是<strong>单调</strong>的。
我们将 H 的单调性表示为 <span class="arithmatex">\(H(\uparrow,\uparrow,\uparrow)\)</span>。</p>
<p>我们有以下充分条件：
单调 <span class="arithmatex">\(\Leftarrow \frac{\partial H}{\partial u_{i}}\ge0\)</span>。
<span class="arithmatex">\(=U_{j}^{m+1}=U_{j}^{m}-\frac{\tau}{h}(f(U_{j}^{m},U_{j+1}^{m})-f(U_{j-1}^{m},U_{j}^{m}))\)</span>，
<span class="arithmatex">\(\frac{\tau}{h}(\partial_{u_{1}}f(u_{1},u_{2})-\partial_{u_{2}}f(u_{1},u_{2}))\le1\)</span>。
<span class="arithmatex">\(\Leftarrow |\nu|\le Q(\nu)\le1\)</span>，这里 <span class="arithmatex">\(|\nu|\le1\)</span> 是 CFL 条件。</p>
<p>一般的格式可以写成数值粘性格式：
<span class="arithmatex">\(U_{j}^{m+1}=\frac{1}{2}(U_{j-1}^{m}+U_{j+1}^{m}) - \frac{\tau}{2h}(f(U_{j+1}^{m})-f(U_{j-1}^{m})) + \frac{h}{2\tau}Q_{j+\frac{1}{2}}^m(U_{j+1}^m - U_j^m)\)</span>
<span class="arithmatex">\(\Leftrightarrow F_{j+\frac{1}{2}}^{m+\frac{1}{2}}=\frac{1}{2}(f(U_{j}^{m})+f(U_{j+1}^{m}))-\frac{h}{2\tau}Q_{j+\frac{1}{2}}^{m}(U_{j+1}^{m}-U_{j}^{m})\)</span>.</p>
<p>Lax-Friedrichs: <span class="arithmatex">\(Q=1\)</span>.
Roe: <span class="arithmatex">\(Q=|a_{j+1/2}^m|\)</span>.
Godunov: <span class="arithmatex">\(Q=\frac{f(U_j)+f(U_{j+1})-2f(u_*(U_j, U_{j+1}))}{h/\tau(U_{j+1}-U_j)}\)</span>.
Lax-Wendroff: <span class="arithmatex">\(Q = (\frac{\tau}{h} a_{j+1/2}^m)^2\)</span>.</p>
<p>然后我们回顾一些性质：
<span class="arithmatex">\(L_{1}\)</span>-压缩: <span class="arithmatex">\(||U^{m+1}||_{L_{1}} \le ||U^{m}||_{L_{1}}\)</span>。
TVD: <span class="arithmatex">\(||U^{m+1}||_{TV} \le ||U^{m}||_{TV}\)</span>，其中 <span class="arithmatex">\(||U^{m}||_{TV}=\sum_{j}|U_{j+1}^{m}-U_{j}^{m}|\)</span>。
保单调: 如果 <span class="arithmatex">\(U_{j}^{m}\le U_{j+1}^{m}\)</span>，则 <span class="arithmatex">\(U_{j}^{m+1}\le U_{j+1}^{m+1}\)</span>。
TVB: <span class="arithmatex">\(||U^{m+1}||_{TV} \le (1+\tau)||U^{m}||_{TV}\)</span>。</p>
<p>可以证明：
单调 <span class="arithmatex">\(\Rightarrow L_{1}\)</span>-压缩 <span class="arithmatex">\(\Rightarrow\)</span> TVD <span class="arithmatex">\(\Rightarrow\)</span> 保单调 (如果线性 <span class="arithmatex">\(\Leftrightarrow\)</span> 单调)。
TVD <span class="arithmatex">\(\Rightarrow\)</span> TVB。</p>
<p>在所有格式（Roe, LW, LF, Godunov）中，LW 仅满足 TVB，其他三种格式满足单调性。</p>
<p><strong>定理 3 (Godunov 定理).</strong> 线性单调格式至多是一阶精度的。
（当 <span class="arithmatex">\(f(u)\)</span> 关于 u 线性时，如果 <span class="arithmatex">\(U_{j}^{m+1}=\sum c_{i}U_{j+i}^{m}\)</span>，即如果 <span class="arithmatex">\(m+1\)</span> 步的近似解可以表示为 <span class="arithmatex">\(m\)</span> 步近似解的线性组合，则它是线性格式。）</p>
<p><strong>注:</strong> Lax-Wendroff 格式是二阶的，所以它不是单调的并且会产生振荡。</p>
<h3 id="53-godunov">5.3 打破 Godunov 定理**</h3>
<ol>
<li>高分辨率方法：通量限制器 (flux limiter)、斜率限制器 (slope limiter)。</li>
<li>高阶半离散方法 / 通量重构方法：RK, RKDG, IMAXDG, ENO, WENO。</li>
</ol>
<p><strong>1. 高分辨率方法:</strong> 结合一阶格式和二阶格式：如果光滑则使用二阶格式，如果不连续则保持一阶以平衡一阶和二阶。</p>
<p><strong>(a) 通量限制器格式:</strong>
例如，考虑迎风和 Lax-Wendroff。
<span class="arithmatex">\(F_{j+\frac{1}{2}}=F_{j+\frac{1}{2}}^{L}+\phi(F_{j+\frac{1}{2}}^{H}-F_{j+\frac{1}{2}}^{L})\)</span>。
<span class="arithmatex">\(F_{j+\frac{1}{2}}^{H}=aU_{j}+\frac{1}{2}a(1-\nu)(U_{j+1}-U_{j})\)</span>，
<span class="arithmatex">\(F_{j+\frac{1}{2}}^{L}=aU_{j}\)</span>。
<span class="arithmatex">\(F_{j+\frac{1}{2}}=F_{j+\frac{1}{2}}^{L}+\phi_{j+\frac{1}{2}}(F_{j+\frac{1}{2}}^{H}-F_{j+\frac{1}{2}}^{L})=aU_{j}+\frac{1}{2}\phi_{j+\frac{1}{2}}a(1-\nu)(U_{j+1}-U_{j})\)</span>，
<span class="arithmatex">\(\phi_{j+\frac{1}{2}}=\phi(\theta_{j+\frac{1}{2}}), \theta_{j+\frac{1}{2}}=\frac{U_{j}-U_{j-1}}{U_{j+1}-U_{j}}\)</span>，
其中通量限制器 <span class="arithmatex">\(\phi(\theta)\)</span> 满足 <span class="arithmatex">\(0\le\phi(\theta)\le2, 0\le\frac{\phi(\theta)}{\theta}\le2\)</span>。函数 <span class="arithmatex">\(\phi(\theta)\)</span> 有以下选择：
<span class="arithmatex">\(\phi(\theta)=\begin{cases}\max\{0,\min\{1,2\theta\},\min\{\theta,2\}\} &amp; \text{(superbee)}\\ \frac{|\theta|+\theta}{1+|\theta|} &amp; \text{(Van Lee)}\end{cases}\)</span></p>
<p><strong>(b) 斜率限制器格式:</strong>
<span class="arithmatex">\(F_{j+\frac{1}{2}}=aU_{j}+\frac{1}{2}a(1-\nu)h\sigma_{j}\)</span>
<span class="arithmatex">\(\sigma_{j}=\frac{U_{j+1}-U_{j}}{h}\phi_{j}\)</span>
可以与通量限制器格式有相同的表达式。
MUSCL 格式选择
<span class="arithmatex">\(\sigma_{j}=\frac{1}{h}\text{minmod}\{U_{j}-U_{j-1},U_{j+1}-U_{j}\}\)</span>
其中 <span class="arithmatex">\(\text{minmod}\{a,b\}=\begin{cases}0,&amp;ab\le0,\\ \text{sign}(a)\min\{|a|,|b|\},&amp;ab&gt;0.\end{cases}\)</span></p>
<p><strong>2. 高阶半离散方法:</strong> 坚持使用具有最小振荡的高阶格式。
我们考虑
<span class="arithmatex">\(\frac{d}{dt}[\int_{x_{j-\frac{1}{2}}}^{x_{j+\frac{1}{2}}}u dx+f(u(x_{j+\frac{1}{2}},t))-f(u(x_{j-\frac{1}{2}},t))]=0\)</span>。
<span class="arithmatex">\(\frac{d}{dt}U_{j}+\frac{1}{h}[F(U_{j+\frac{1}{2}},t)-F(U_{j-\frac{1}{2}},t)]=0\)</span>。</p>
<p><strong>时间重构方法:</strong> 高阶 ODE 求解器，如 Runge-Kutta 方法。</p>
<p><strong>空间重构方法:</strong> ENO (Essentially Non-oscillatory) 格式通过优化 <span class="arithmatex">\(U_{j}^{m}\)</span> 的有限差分系数来重构 <span class="arithmatex">\(U_{j+\frac{1}{2}}^{m}\)</span>，从而最小化振荡（使用光滑度指示器: SI）：
<span class="arithmatex">\(\min_{c_{l}}SI=(U_{j+\frac{1}{2}}^{m}-U_{j-\frac{1}{2}}^{m})^{2}\)</span>，
s.t. <span class="arithmatex">\(U_{j+\frac{1}{2}}^{m}=\sum_{l}c_{l}U_{l}^{m}\)</span>。</p>
<p><br></p>
<hr>

<div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
<p><a class="md-button" href="../chapter2/"> <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.78 19.03a.75.75 0 0 1-1.06 0l-6.25-6.25a.75.75 0 0 1 0-1.06l6.25-6.25a.749.749 0 0 1 1.275.326.75.75 0 0 1-.215.734L5.81 11.5h14.44a.75.75 0 0 1 0 1.5H5.81l4.97 4.97a.75.75 0 0 1 0 1.06"/></svg></span>  上一章：抛物 PDE 的有限差分法 </a></p>
<p><a class="md-button md-button--primary" href="./"> 下一章：还没写 <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0"/></svg></span> </a></p>
</div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="最后更新">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="2025年11月22日 16:45:50 UTC">2025年11月22日</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="创建日期">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="2025年11月22日 16:45:50 UTC">2025年11月22日</span>
  </span>

    
    
    
  </aside>



  



                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      copyright © zdd All Rights Reserved
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/zdd14990" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "navigation.indexes", "navigation.expand", "search.highlight", "search.suggest", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
  
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="../../../javascripts/click_effect.js"></script>
      
        <script src="../../../javascripts/vanilla-tilt.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../javascripts/funny_title.js"></script>
      
        <script src="../../../javascripts/smooth_trail.js"></script>
      
    
  <script>
  document.addEventListener("DOMContentLoaded", function() {
      // 1. 创建进度条容器
      var progressBar = document.createElement("div");
      progressBar.id = "reading-progress";
      // 样式：固定顶部，高度3px，粉色，初始宽度0
      progressBar.style.cssText = "position: fixed; top: 0; left: 0; height: 3px; background: #e67e96; width: 0%; z-index: 99999; transition: width 0.1s ease;";
      document.body.appendChild(progressBar);

      // 2. 监听滚动事件
      window.addEventListener("scroll", function() {
          var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
          var scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
          var scrolled = (scrollTop / scrollHeight) * 100;
          progressBar.style.width = scrolled + "%";
      });
  });
</script>
  <style>
    body[data-md-color-scheme="default"]::before {
        background-image: url('../../../assets/site_bg_light.jpg');
    }
    body[data-md-color-scheme="slate"]::after {
        background-image: url('../../../assets/site_bg_dark.jpg');
    }
  </style>

  <script>
  (function() {
      var audioPath = "../../../assets/bgm.mp3";

      if (!window.myGlobalAudio) {
          window.myGlobalAudio = new Audio(audioPath);
          window.myGlobalAudio.loop = true; 
          window.myGlobalAudio.volume = 0.5; 
      }

      var oldBtn = document.getElementById('my-simple-player');
      if (oldBtn) oldBtn.remove();

      var playerContainer = document.createElement('div');
      playerContainer.id = 'my-simple-player';
      playerContainer.className = 'simple-player-floating';
      playerContainer.innerHTML = `
          <div class="player-icon" id="player-btn" title="点击播放/暂停">
              <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M9 18V5l12-2v13"></path>
                  <circle cx="6" cy="18" r="3"></circle>
                  <circle cx="18" cy="16" r="3"></circle>
              </svg>
          </div>
      `;
      document.body.appendChild(playerContainer);

      var btnIcon = document.getElementById('player-btn');
      var audio = window.myGlobalAudio;

      audio.onerror = function() {
          console.error("BGM加载失败:", audioPath);
      };

      if (!audio.paused) {
          btnIcon.classList.add('playing');
      }

      btnIcon.onclick = function() {
          if (audio.paused) {
              var p = audio.play();
              if (p !== undefined) {
                  p.then(_ => btnIcon.classList.add('playing')).catch(e => console.error(e));
              }
          } else {
              audio.pause();
              btnIcon.classList.remove('playing');
          }
      };
  })();
  </script>

  <script>
    document$.subscribe(function() {
        var h1 = document.querySelector(".md-content__inner h1");
        var isHomePage = location.pathname === "/" || location.pathname.endsWith("index.html");
        
        if (h1 && !document.getElementById("page-pv-container") && !isHomePage) {
            var pvContainer = document.createElement("div");
            pvContainer.id = "page-pv-container";
            pvContainer.style.cssText = "color: var(--md-default-fg-color--light); font-size: 0.8rem; margin-top: -10px; margin-bottom: 20px;";
            pvContainer.innerHTML = `
                <span id="busuanzi_container_page_pv" style="display: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" style="vertical-align: sub; fill: currentColor; margin-right: 4px;">
                        <path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5Z"/>
                    </svg>
                    阅读量：<span id="busuanzi_value_page_pv" style="font-weight: bold;">--</span>
                </span>
            `;
            h1.parentNode.insertBefore(pvContainer, h1.nextSibling);
        }

        var oldScript = document.getElementById("busuanzi-script-tag");
        if (oldScript) { oldScript.remove(); }
        
        var sitePv = document.getElementById("busuanzi_container_site_pv");
        if (sitePv) sitePv.style.display = "none";

        var script = document.createElement("script");
        script.id = "busuanzi-script-tag";
        script.src = "//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js";
        script.async = true;
        document.body.appendChild(script);
    });
  </script>

  <script>
    document$.subscribe(function() {
        var card = document.querySelector(".profile-card");
        if (!card) return;

        function initTilt() {
            if (window.VanillaTilt) {
                if (card.vanillaTilt) card.vanillaTilt.destroy();
                VanillaTilt.init(card, {
                    max: 8,
                    speed: 1000,
                    glare: true,
                    "max-glare": 0.2,
                    scale: 1.05,
                    gyroscope: false,
                    perspective: 1000
                });
                return true;
            }
            return false;
        }

        if (!initTilt()) {
            var checkTilt = setInterval(function() {
                if (initTilt()) {
                    clearInterval(checkTilt);
                }
            }, 100);
        }
    });
  </script>


  </body>
</html>